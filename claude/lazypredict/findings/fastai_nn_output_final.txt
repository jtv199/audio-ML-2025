================================================================================
FASTAI TABULAR NEURAL NETWORK TRAINING
================================================================================

================================================================================
PREPARING DATASETS
================================================================================

Loading FreeSound dataset...
  Samples: 4268
  Classes: 74
  Features: 2474

Loading ESC-50 dataset...
  Samples: 2000
  Classes: 50
  Features: 2474


================================================================================
FREESOUND EXPERIMENTS
================================================================================

================================================================================
Training 2-Layer NN on FreeSound
Architecture: [200, 100]
================================================================================

Train samples: 3414
Valid samples: 854

Training for 10 epochs...
█epoch     train_loss  valid_loss  accuracy  time    
█Epoch 1/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 1/10 : |----------------------------------------| 1.89% [1/53 00:00<00:02]Epoch 1/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:01 4.5324]Epoch 1/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:01 4.5491]Epoch 1/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 4.4916]Epoch 1/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 4.4605]Epoch 1/10 : |████████████----------------------------| 30.19% [16/53 00:00<00:00 4.2813]Epoch 1/10 : |█████████████████████-------------------| 54.72% [29/53 00:00<00:00 4.1312]Epoch 1/10 : |███████████████████████████████---------| 79.25% [42/53 00:00<00:00 4.0203]Epoch 1/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 3.9241]Epoch 1/10 :                                                                              Epoch 1/10 :                                                                              █Epoch 1/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 1/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 1/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 3.9167]Epoch 1/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 3.9167]Epoch 1/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 3.9167]Epoch 1/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 3.9167]Epoch 1/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 3.9167]Epoch 1/10 :                                                                              Epoch 1/10 :                                                                              0         3.916704    3.672953    0.196952  00:00     
█Epoch 2/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 2/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 2/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 3.9071]Epoch 2/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 3.8977]Epoch 2/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 3.8852]Epoch 2/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 3.8768]Epoch 2/10 : |███████████████-------------------------| 37.74% [20/53 00:00<00:00 3.7386]Epoch 2/10 : |██████████████████████████--------------| 66.04% [35/53 00:00<00:00 3.6104]Epoch 2/10 : |██████████████████████████████████████--| 96.23% [51/53 00:00<00:00 3.4994]Epoch 2/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 3.4972]Epoch 2/10 :                                                                              Epoch 2/10 :                                                                              █Epoch 2/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 2/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 2/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 3.4840]Epoch 2/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 3.4840]Epoch 2/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 3.4840]Epoch 2/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 3.4840]Epoch 2/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 3.4840]Epoch 2/10 :                                                                              Epoch 2/10 :                                                                              1         3.483989    3.176944    0.264947  00:00     
█Epoch 3/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 3/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 3/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 3.4745]Epoch 3/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 3.4617]Epoch 3/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 3.4562]Epoch 3/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 3.4494]Epoch 3/10 : |██████████████--------------------------| 35.85% [19/53 00:00<00:00 3.3296]Epoch 3/10 : |█████████████████████████---------------| 64.15% [34/53 00:00<00:00 3.2286]Epoch 3/10 : |█████████████████████████████████████---| 94.34% [50/53 00:00<00:00 3.1153]Epoch 3/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 3.0998]Epoch 3/10 :                                                                              Epoch 3/10 :                                                                              █Epoch 3/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 3/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 3/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 3.0971]Epoch 3/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 3.0971]Epoch 3/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 3.0971]Epoch 3/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 3.0971]Epoch 3/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 3.0971]Epoch 3/10 :                                                                              Epoch 3/10 :                                                                              2         3.097051    2.840241    0.301290  00:00     
█Epoch 4/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 4/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 4/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 3.0885]Epoch 4/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 3.0784]Epoch 4/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 3.0717]Epoch 4/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 3.0639]Epoch 4/10 : |█████████████---------------------------| 33.96% [18/53 00:00<00:00 2.9498]Epoch 4/10 : |████████████████████████----------------| 60.38% [32/53 00:00<00:00 2.8744]Epoch 4/10 : |██████████████████████████████████------| 86.79% [46/53 00:00<00:00 2.8117]Epoch 4/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 2.7626]Epoch 4/10 :                                                                              Epoch 4/10 :                                                                              █Epoch 4/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 4/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 4/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 2.7585]Epoch 4/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 2.7585]Epoch 4/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 2.7585]Epoch 4/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 2.7585]Epoch 4/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 2.7585]Epoch 4/10 :                                                                              Epoch 4/10 :                                                                              3         2.758535    2.594174    0.391559  00:00     
█Epoch 5/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 5/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 5/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 2.7483]Epoch 5/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 2.7425]Epoch 5/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 2.7359]Epoch 5/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 2.7288]Epoch 5/10 : |███████████████-------------------------| 37.74% [20/53 00:00<00:00 2.6252]Epoch 5/10 : |██████████████████████████--------------| 66.04% [35/53 00:00<00:00 2.5608]Epoch 5/10 : |██████████████████████████████████████--| 96.23% [51/53 00:00<00:00 2.5153]Epoch 5/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 2.5117]Epoch 5/10 :                                                                              Epoch 5/10 :                                                                              █Epoch 5/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 5/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 5/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 2.5152]Epoch 5/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 2.5152]Epoch 5/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 2.5152]Epoch 5/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 2.5152]Epoch 5/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 2.5152]Epoch 5/10 :                                                                              Epoch 5/10 :                                                                              4         2.515177    2.463354    0.399766  00:00     
█Epoch 6/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 6/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 6/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 2.5045]Epoch 6/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 2.5038]Epoch 6/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 2.4990]Epoch 6/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 2.4921]Epoch 6/10 : |███████████████-------------------------| 37.74% [20/53 00:00<00:00 2.4019]Epoch 6/10 : |█████████████████████████---------------| 64.15% [34/53 00:00<00:00 2.3405]Epoch 6/10 : |██████████████████████████████████------| 86.79% [46/53 00:00<00:00 2.3232]Epoch 6/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 2.3067]Epoch 6/10 :                                                                              Epoch 6/10 :                                                                              █Epoch 6/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 6/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 6/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 2.3019]Epoch 6/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 2.3019]Epoch 6/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 2.3019]Epoch 6/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 2.3019]Epoch 6/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 2.3019]Epoch 6/10 :                                                                              Epoch 6/10 :                                                                              5         2.301899    2.277051    0.444314  00:00     
█Epoch 7/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 7/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 7/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 2.2974]Epoch 7/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 2.2928]Epoch 7/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 2.2912]Epoch 7/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 2.2872]Epoch 7/10 : |██████████████--------------------------| 35.85% [19/53 00:00<00:00 2.2065]Epoch 7/10 : |█████████████████████████---------------| 64.15% [34/53 00:00<00:00 2.1674]Epoch 7/10 : |████████████████████████████████████----| 92.45% [49/53 00:00<00:00 2.1254]Epoch 7/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 2.1167]Epoch 7/10 :                                                                              Epoch 7/10 :                                                                              █Epoch 7/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 7/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 7/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 2.1166]Epoch 7/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 2.1166]Epoch 7/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 2.1166]Epoch 7/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 2.1166]Epoch 7/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 2.1166]Epoch 7/10 :                                                                              Epoch 7/10 :                                                                              6         2.116588    2.208385    0.472450  00:00     
█Epoch 8/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 8/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 8/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 2.1114]Epoch 8/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 2.1081]Epoch 8/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 2.1027]Epoch 8/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 2.0967]Epoch 8/10 : |███████████████-------------------------| 37.74% [20/53 00:00<00:00 2.0413]Epoch 8/10 : |██████████████████████████--------------| 66.04% [35/53 00:00<00:00 1.9937]Epoch 8/10 : |██████████████████████████████████████--| 96.23% [51/53 00:00<00:00 1.9406]Epoch 8/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 1.9371]Epoch 8/10 :                                                                              Epoch 8/10 :                                                                              █Epoch 8/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 8/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 8/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 1.9345]Epoch 8/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 1.9345]Epoch 8/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 1.9345]Epoch 8/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 1.9345]Epoch 8/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 1.9345]Epoch 8/10 :                                                                              Epoch 8/10 :                                                                              7         1.934489    2.144496    0.485346  00:00     
█Epoch 9/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 9/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 9/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 1.9286]Epoch 9/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 1.9233]Epoch 9/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 1.9186]Epoch 9/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 1.9180]Epoch 9/10 : |███████████████-------------------------| 37.74% [20/53 00:00<00:00 1.8574]Epoch 9/10 : |█████████████████████████---------------| 64.15% [34/53 00:00<00:00 1.8209]Epoch 9/10 : |███████████████████████████████████-----| 88.68% [47/53 00:00<00:00 1.7839]Epoch 9/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 1.7928]Epoch 9/10 :                                                                              Epoch 9/10 :                                                                              █Epoch 9/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 9/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 9/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 1.7996]Epoch 9/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 1.7996]Epoch 9/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 1.7996]Epoch 9/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 1.7996]Epoch 9/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 1.7996]Epoch 9/10 :                                                                              Epoch 9/10 :                                                                              8         1.799641    2.078309    0.498242  00:00     
█Epoch 10/10 : |----------------------------------------| 0.00% [0/53 00:00<?]Epoch 10/10 : |----------------------------------------| 1.89% [1/53 00:00<00:00]Epoch 10/10 : |█---------------------------------------| 3.77% [2/53 00:00<00:00 1.7968]Epoch 10/10 : |██--------------------------------------| 5.66% [3/53 00:00<00:00 1.7967]Epoch 10/10 : |███-------------------------------------| 7.55% [4/53 00:00<00:00 1.7921]Epoch 10/10 : |███-------------------------------------| 9.43% [5/53 00:00<00:00 1.7874]Epoch 10/10 : |███████████████-------------------------| 37.74% [20/53 00:00<00:00 1.7485]Epoch 10/10 : |███████████████████████████-------------| 67.92% [36/53 00:00<00:00 1.7477]Epoch 10/10 : |███████████████████████████████████████-| 98.11% [52/53 00:00<00:00 1.7143]Epoch 10/10 : |████████████████████████████████████████| 100.00% [53/53 00:00<00:00 1.7092]Epoch 10/10 :                                                                              Epoch 10/10 :                                                                              █Epoch 10/10 : |----------------------------------------| 0.00% [0/14 00:00<?]Epoch 10/10 : |██--------------------------------------| 7.14% [1/14 00:00<00:00]Epoch 10/10 : |█████-----------------------------------| 14.29% [2/14 00:00<00:00 1.7115]Epoch 10/10 : |████████--------------------------------| 21.43% [3/14 00:00<00:00 1.7115]Epoch 10/10 : |███████████-----------------------------| 28.57% [4/14 00:00<00:00 1.7115]Epoch 10/10 : |██████████████--------------------------| 35.71% [5/14 00:00<00:00 1.7115]Epoch 10/10 : |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 1.7115]Epoch 10/10 :                                                                              Epoch 10/10 :                                                                              9         1.711540    2.071374    0.500586  00:00     
█ |----------------------------------------| 0.00% [0/14 00:00<?] |██--------------------------------------| 7.14% [1/14 00:00<00:00] |█████-----------------------------------| 14.29% [2/14 00:00<00:00 1.7115] |████████--------------------------------| 21.43% [3/14 00:00<00:00 1.7115] |███████████-----------------------------| 28.57% [4/14 00:00<00:00 1.7115] |██████████████--------------------------| 35.71% [5/14 00:00<00:00 1.7115] |████████████████████████████████████████| 100.00% [14/14 00:00<00:00 1.7115]                                                                                                                                                            
================================================================================
RESULTS - 2-Layer NN on FreeSound
================================================================================
Overall Accuracy:      0.5006 (50.06%)
Balanced Accuracy:     0.4543 (45.43%)
F1 Score (weighted):   0.4792

Traceback (most recent call last):
  File "claude/fastai_tabular_nn.py", line 277, in <module>
    main()
  File "claude/fastai_tabular_nn.py", line 193, in main
    result = train_nn(freesound_df, freesound_features, arch_2layer,
  File "claude/fastai_tabular_nn.py", line 160, in train_nn
    'train_samples': len(train_df),
NameError: name 'train_df' is not defined
